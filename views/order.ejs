<!DOCTYPE html>
<html lang="en">

<head>
  <!-- bootstrap -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css"
    integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">

  <link rel="stylesheet" href="/vendor/normalize-4.1.1.css" type="text/css" />
  <link rel="stylesheet" href="/vendor/border-box.css" type="text/css" />
  <link rel="stylesheet" href="/styles/main.css" type="text/css" />
  <link rel="stylesheet" href="/styles/layout.css" type="text/css" />
  <link rel="stylesheet" href="/styles/order.css" type="text/css" />

  <script type="text/javascript" src="/vendor/jquery-3.0.0.js"></script>
  <script type="text/javascript" src="/scripts/app.js"></script>
  <title>Order Summary</title>

    <!-- fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

</head>

<body>
  <%- include('partials/_header', { user: user}) %>
  <div class="order-container">
    <div class="order-summary">
      Order Summary
    </div>

    <div class="order-detail">
      <span><span class="order-label">Order Number: </span><%= orderDetails[0].id %></span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Name: </span><%= orderDetails[0].customer_name%></span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Phone Number: </span><%= orderDetails[0].phone_number%></span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Email: </span><%= orderDetails[0].email%></span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Order Placed At: </span>
      <% const event = new Date(orderDetails[0].order_placed_at); %>

      <%= event.toLocaleString('en-GB', { timeZone: 'UTC' })

      %></span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Items Ordered: </span>

      <% if (orderDetails.length === 1) {%>
        <%= orderDetails[0].item_name %> x <%= orderDetails[0].cnt %> $<%= orderDetails[0].price%>
        <% } else {%>
      <% for (let i=0; i<orderDetails.length; i++) { %>
        <% if (i < orderDetails.length - 1) { %>
          <%= orderDetails[i].item_name %> x <%= orderDetails[i].cnt %> $<%= orderDetails[i].price%>
          <%- ", &nbsp;"%>
          <% } else if (i === orderDetails.length - 1) {%>
        <%= orderDetails[i].item_name %> x <%= orderDetails[i].cnt %> $<%= orderDetails[i].price%>
        <% }}} %>
      </span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Order Total: </span><% let sum = 0; for (let i=0; i<orderDetails.length; i++) { %>
        <% let num = Number(orderDetails[i].price); let cnt = Number(orderDetails[i].cnt); sum += num*cnt; %>
        <% } %>
        $<%= sum.toFixed(2) %>
      </span>
    </div>

    <div class="order-detail">
      <span><span class="order-label">Order Status: </span>
      <% if (orderDetails[0].order_completed_at) { %>
        Ready for pickup
      <% } else if (orderDetails[0].order_started_at) { %>
        Confirmed
      <% } else { %>
        Pending restaurant confirmation
      <% } %>
      </span>
    </div>

    <form method="post" action="/api/menu/delete" id="cancel" onclick="checker()">
      <button type="button" class="cancel">Cancel Order</button>
    </form>
  </div>
</body>
<script type="text/javascript" src="/scripts/orders.js"></script>
</html>
